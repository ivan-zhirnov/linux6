# linux6

## Задание  
1) Создать свой RPM пакет (можно взять свое приложение, либо собрать, например, nginx с определенными опциями);
2) Создать свой репозиторий и разместить там ранее собранный RPM.

## Выполнение  
1. Для примера возьмем пакет NGINX и соберем его с поддержкой openssl  
* Для данного задания нам понадобятся следующие установленные пакеты:  
![]()  
* Загрузим SRPM пакет NGINX для дальнейшей работы над ним:  
![]()  
* При установке такого пакета в домашней директории создается древо каталогов для сборки:  
![]()  
* Также нужно скачать и разархивировать последние исходники для openssl, т.к. они потребуется при сборке:  
![]()  
* Заранее поставим все зависимости чтобы в процессе сборки не было ошибок:  
![]()  
* Ну и собственно поправить сам spec файл чтобы NGINX собирался с необходимыми нам опциями:  
![]()  
* Теперь можно приступить к сборке RPM пакета:  
![]()  
* Убедимся что пакеты создались:  
![]()  
* Теперь можно установить наш пакет и убедиться что nginx работает:  
![]()  
Далее мы будем использовать его для доступа к своему репозиторию  
![]()  
2. Теперь приступим к созданию своего репозитория.  
Директория для статики у NGINX по умолчанию /usr/share/nginx/html  
![]()  
* Создадим там каталог repo:  
![]()  
* Копируем туда наш собранный RPM и, например, RPM для установки репозитория Percona-Server:  
![]()  
* Инициализируем репозиторий командой:  
![]()  
* Для прозрачности настроим в NGINX доступ к листингу каталога:
В location / в файле /etc/nginx/conf.d/default.conf добавим директиву autoindex on. В результате location будет выглядеть так:
![]()  
* Проверяем синтаксис и перезапускаем NGINX:  
![]()  
* Теперь ради интереса можно посмотреть в браузере или curl-ануть:  
![]()  
* Все готово для того, чтобы протестировать репозиторий! Добавим его в /etc/yum.repos.d:  
![]()  
* Убедимся что репозиторий подключился и посмотрим что в нем есть:  
![]()  
* Переустановим nginx из нашего репозитория:  
![]()  
* Посмотрим список всех пакетов, отфильтровав их:  
![]()  
* Установим репозиторий percona-release из нашего репозитория:  
![]()  

